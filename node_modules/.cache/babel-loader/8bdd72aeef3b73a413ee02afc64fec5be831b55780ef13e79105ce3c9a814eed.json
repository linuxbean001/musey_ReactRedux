{"ast":null,"code":"var _s = $RefreshSig$();\n// StripeCheckoutButton.js\nimport React, { useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst StripeCheckoutButton = _ref => {\n  _s();\n  let {\n    publicKey,\n    userId\n  } = _ref;\n  const history = useHistory();\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await fetch(`/create-checkout-session?userid=${userId}`);\n        const data = await response.json();\n        console.log(data);\n        redirectToStripeCheckout(data.sessionId);\n      } catch (error) {\n        console.error(\"Error fetching data:\", error);\n      }\n    };\n    const redirectToStripeCheckout = sessionId => {\n      const stripeScript = document.createElement(\"script\");\n      stripeScript.src = \"https://js.stripe.com/v3/\";\n      stripeScript.async = true;\n      stripeScript.onload = () => {\n        const stripe = window.Stripe(publicKey);\n        stripe.redirectToCheckout({\n          sessionId\n        }).then(result => {\n          // Handle any errors during the redirection if needed\n          console.log(\"Redirect result:\", result);\n\n          // Check if the payment was successful and redirect to the success page\n          if (result.error) {\n            console.error(\"Payment error:\", result.error.message);\n          } else if (result.payment_intent && result.payment_intent.status === \"succeeded\") {\n            history.push(\"/success\");\n          }\n        }).catch(error => {\n          console.error(\"Error redirecting to Stripe Checkout:\", error);\n        });\n      };\n      document.body.appendChild(stripeScript);\n    };\n    fetchData();\n  }, [publicKey, userId, history]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false); // You can return null or an empty fragment since this component doesn't render anything\n};\n_s(StripeCheckoutButton, \"bz2N+u0mX89LO9zOCfVCA9Sa20M=\", false, function () {\n  return [useHistory];\n});\n_c = StripeCheckoutButton;\nexport default StripeCheckout;\nvar _c;\n$RefreshReg$(_c, \"StripeCheckoutButton\");","map":{"version":3,"names":["React","useEffect","useHistory","Fragment","_Fragment","jsxDEV","_jsxDEV","StripeCheckoutButton","_ref","_s","publicKey","userId","history","fetchData","response","fetch","data","json","console","log","redirectToStripeCheckout","sessionId","error","stripeScript","document","createElement","src","async","onload","stripe","window","Stripe","redirectToCheckout","then","result","message","payment_intent","status","push","catch","body","appendChild","_c","StripeCheckout","$RefreshReg$"],"sources":["D:/Prashant/ReduxProject(PS)/AI Generation Context API/musey_ReactRedux/src/StripeCheckout.js"],"sourcesContent":["// StripeCheckoutButton.js\r\nimport React, { useEffect } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nconst StripeCheckoutButton = ({ publicKey, userId }) => {\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await fetch(\r\n          `/create-checkout-session?userid=${userId}`\r\n        );\r\n        const data = await response.json();\r\n        console.log(data);\r\n        redirectToStripeCheckout(data.sessionId);\r\n      } catch (error) {\r\n        console.error(\"Error fetching data:\", error);\r\n      }\r\n    };\r\n\r\n    const redirectToStripeCheckout = (sessionId) => {\r\n      const stripeScript = document.createElement(\"script\");\r\n      stripeScript.src = \"https://js.stripe.com/v3/\";\r\n      stripeScript.async = true;\r\n      stripeScript.onload = () => {\r\n        const stripe = window.Stripe(publicKey);\r\n        stripe\r\n          .redirectToCheckout({ sessionId })\r\n          .then((result) => {\r\n            // Handle any errors during the redirection if needed\r\n            console.log(\"Redirect result:\", result);\r\n\r\n            // Check if the payment was successful and redirect to the success page\r\n            if (result.error) {\r\n              console.error(\"Payment error:\", result.error.message);\r\n            } else if (\r\n              result.payment_intent &&\r\n              result.payment_intent.status === \"succeeded\"\r\n            ) {\r\n              history.push(\"/success\");\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            console.error(\"Error redirecting to Stripe Checkout:\", error);\r\n          });\r\n      };\r\n\r\n      document.body.appendChild(stripeScript);\r\n    };\r\n\r\n    fetchData();\r\n  }, [publicKey, userId, history]);\r\n\r\n  return <></>; // You can return null or an empty fragment since this component doesn't render anything\r\n};\r\n\r\nexport default StripeCheckout;\r\n"],"mappings":";AAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,UAAU,QAAQ,kBAAkB;AAAC,SAAAC,QAAA,IAAAC,SAAA;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAE9C,MAAMC,oBAAoB,GAAGC,IAAA,IAA2B;EAAAC,EAAA;EAAA,IAA1B;IAAEC,SAAS;IAAEC;EAAO,CAAC,GAAAH,IAAA;EACjD,MAAMI,OAAO,GAAGV,UAAU,CAAC,CAAC;EAE5BD,SAAS,CAAC,MAAM;IACd,MAAMY,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC5B,IAAI;QACF,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CACzB,mCAAkCJ,MAAO,EAC5C,CAAC;QACD,MAAMK,IAAI,GAAG,MAAMF,QAAQ,CAACG,IAAI,CAAC,CAAC;QAClCC,OAAO,CAACC,GAAG,CAACH,IAAI,CAAC;QACjBI,wBAAwB,CAACJ,IAAI,CAACK,SAAS,CAAC;MAC1C,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdJ,OAAO,CAACI,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC9C;IACF,CAAC;IAED,MAAMF,wBAAwB,GAAIC,SAAS,IAAK;MAC9C,MAAME,YAAY,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;MACrDF,YAAY,CAACG,GAAG,GAAG,2BAA2B;MAC9CH,YAAY,CAACI,KAAK,GAAG,IAAI;MACzBJ,YAAY,CAACK,MAAM,GAAG,MAAM;QAC1B,MAAMC,MAAM,GAAGC,MAAM,CAACC,MAAM,CAACrB,SAAS,CAAC;QACvCmB,MAAM,CACHG,kBAAkB,CAAC;UAAEX;QAAU,CAAC,CAAC,CACjCY,IAAI,CAAEC,MAAM,IAAK;UAChB;UACAhB,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEe,MAAM,CAAC;;UAEvC;UACA,IAAIA,MAAM,CAACZ,KAAK,EAAE;YAChBJ,OAAO,CAACI,KAAK,CAAC,gBAAgB,EAAEY,MAAM,CAACZ,KAAK,CAACa,OAAO,CAAC;UACvD,CAAC,MAAM,IACLD,MAAM,CAACE,cAAc,IACrBF,MAAM,CAACE,cAAc,CAACC,MAAM,KAAK,WAAW,EAC5C;YACAzB,OAAO,CAAC0B,IAAI,CAAC,UAAU,CAAC;UAC1B;QACF,CAAC,CAAC,CACDC,KAAK,CAAEjB,KAAK,IAAK;UAChBJ,OAAO,CAACI,KAAK,CAAC,uCAAuC,EAAEA,KAAK,CAAC;QAC/D,CAAC,CAAC;MACN,CAAC;MAEDE,QAAQ,CAACgB,IAAI,CAACC,WAAW,CAAClB,YAAY,CAAC;IACzC,CAAC;IAEDV,SAAS,CAAC,CAAC;EACb,CAAC,EAAE,CAACH,SAAS,EAAEC,MAAM,EAAEC,OAAO,CAAC,CAAC;EAEhC,oBAAON,OAAA,CAAAF,SAAA,mBAAI,CAAC,CAAC,CAAC;AAChB,CAAC;AAACK,EAAA,CAnDIF,oBAAoB;EAAA,QACRL,UAAU;AAAA;AAAAwC,EAAA,GADtBnC,oBAAoB;AAqD1B,eAAeoC,cAAc;AAAC,IAAAD,EAAA;AAAAE,YAAA,CAAAF,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}